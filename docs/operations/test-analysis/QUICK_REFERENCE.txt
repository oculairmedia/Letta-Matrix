QUICK REFERENCE: test_detect_agent_name_change FIXES
=====================================================

HTTP ENDPOINTS CALLED:
1. GET /v1/agents (Letta) - ✓ MOCKED
2. POST /_matrix/client/r0/login (Matrix) - ❌ NOT MOCKED
3. PUT /_matrix/client/r0/rooms/{id}/state/m.room.name (Matrix) - ⚠️ MOCKED BUT NOT VERIFIED
4. PUT /_matrix/client/r0/profile/{user_id}/displayname (Matrix) - ❌ NOT MOCKED

REQUEST PATTERNS:

POST /_matrix/client/r0/login
  {
    "type": "m.login.password",
    "user": "matrixadmin",
    "password": "admin_password"
  }
  → Response: {"access_token": "...", "user_id": "@admin:matrix.test"}

PUT /_matrix/client/r0/rooms/!room:matrix.test/state/m.room.name
  {
    "name": "New Name - Letta Agent Chat"
  }
  → Response: {}

PUT /_matrix/client/r0/profile/@agent_rename:matrix.test/displayname
  {
    "displayname": "New Name"
  }
  → Response: {}

CRITICAL ISSUES:
1. Test calls get_letta_agents() instead of sync_agents_to_users()
2. Admin token endpoint not mocked
3. Display name update endpoint not mocked
4. HTTP calls are not verified

FILES TO MODIFY:
- /home/user/Letta-Matrix/tests/conftest.py (add 4 fixtures)
- /home/user/Letta-Matrix/tests/integration/test_multi_agent_workflow.py (fix test)

FIXTURES NEEDED:
1. mock_admin_token_response
2. mock_agents_list_response
3. mock_matrix_state_update_response
4. mock_matrix_profile_update_response

See detailed guides at:
- /tmp/test_analysis.md
- /tmp/fix_implementation_guide.md
- /tmp/comprehensive_summary.md
